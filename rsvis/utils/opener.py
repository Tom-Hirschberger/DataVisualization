# ===========================================================================
#   opener.py ---------------------------------------------------------------
# ===========================================================================

#   import ------------------------------------------------------------------
# ---------------------------------------------------------------------------
from rsvis.utils import imgio

import subprocess

#   class -------------------------------------------------------------------
# ---------------------------------------------------------------------------
class Opener():

    #   method --------------------------------------------------------------
    # -----------------------------------------------------------------------
    def __init__(self, opener, logger=None):
        self._opener = opener
        self._logger = logger

    #   method --------------------------------------------------------------
    # -----------------------------------------------------------------------
    def __call__(self, opener, *args, path=""):
        imgio.show_open_str(path, self._logger)
        subprocess.Popen(self.get_args(self._opener[opener], path, *args))

    #   method --------------------------------------------------------------
    # -----------------------------------------------------------------------
    def get_args(self, cmd, *args):
        cmd = cmd.copy() if isinstance(cmd, list) else [cmd]
        for a in args:
            cmd.extend(*self.to_list(a))
        
        return " ".join(cmd)

    #   method --------------------------------------------------------------
    # -----------------------------------------------------------------------
    def to_list(self, *args):
        return (x if isinstance(x, list) or x is None else [x] for x in args)

#   class -------------------------------------------------------------------
# ---------------------------------------------------------------------------
class GeneralOpener(Opener):

    #   method --------------------------------------------------------------
    # -----------------------------------------------------------------------
    def __init__(self, opener=dict(), **kwargs):

        opener.update({
                "files": "explorer.exe"
            }
        )

        super(GeneralOpener, self).__init__(opener, **kwargs)
        
